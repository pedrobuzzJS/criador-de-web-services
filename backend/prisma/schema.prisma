// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Users {
  id                 Int                @id @default(autoincrement())
  name               String
  username           String             @unique
  email              String             @unique
  email_verified     Boolean            @default(false)
  password           String
  remember_token     String?
  status_id          Int?
  status             Status?            @relation(fields: [status_id], references: [id])
  created_at         DateTime?          @default(now())
  updated_at         String?
  usuario_permissoes UsuarioPermissao[]
  usuario_papeis     UsuarioPapel[]

  @@map("tbusuarios")
}

model Cores {
  id         Int      @id @default(autoincrement())
  descricao  String
  cor        String
  created_at DateTime
  updated_at DateTime

  @@map("tbcores")
}

model Acoes {
  id         Int      @id
  descricao  String
  metodo     String
  created_at DateTime
  updated_at DateTime

  @@map("tbacoes")
}

model Menus {
  id           Int       @id
  nome         String
  parametros   String
  rota         String?
  icone        String
  pai_id       Int?
  ordem        Int
  desabilitado Boolean   @default(false)
  papel        Int?
  permissao    Int?
  status_id    Int?
  status       Status?   @relation(fields: [status_id], references: [id])
  created_at   DateTime? @default(now())
  updated_at   DateTime?

  @@map("tbmenus")
}

model Papel {
  id              Int              @id
  nome            String
  descricao       String
  created_at      DateTime
  usuarioPapeis   UsuarioPapel[]
  papelPermissoes PapelPermissao[]

  @@map("tbpapeis")
}

model Permissao {
  id                 Int                @id
  nome               String
  descricao          String
  created_at         DateTime
  usuario_permissoes UsuarioPermissao[]
  pepelPermissoes    PapelPermissao[]

  @@map("tbpermissoes")
}

model PapelPermissao {
  papel_id     Int
  papeis       Papel     @relation(fields: [papel_id], references: [id])
  permissao_id Int
  permissoes   Permissao @relation(fields: [permissao_id], references: [id])

  @@id([papel_id, permissao_id])
  @@map("tbpapelpermissoes")
}

model UsuarioPermissao {
  usuario_id   Int
  Usuario      Users     @relation(fields: [usuario_id], references: [id])
  permissao_id Int
  permissao    Permissao @relation(fields: [permissao_id], references: [id])

  @@id([usuario_id, permissao_id])
  @@map("tbusuariopermissoes")
}

model UsuarioPapel {
  usuario_id Int
  Usuario    Users @relation(fields: [usuario_id], references: [id])
  papel_id   Int
  Papel      Papel @relation(fields: [papel_id], references: [id])

  @@id([usuario_id, papel_id])
  @@map("tbusuariopapeis")
}

model Status {
  id              Int              @id @default(autoincrement())
  nome            String
  descricao       String
  Menus           Menus[]
  Users           Users[]
  TipoWebServises TipoWebService[]
  Bases           Bases[]
  Tabelas         Tabelas[]
  TabelasLigacoes TabelaLigacao[]
  WebServices     WebService[]
  TipoBase        TipoBases[]
  Rotas           Rotas[]
  Colunas         Colunas[]

  @@map("tbstatus")
}

model TipoWebService {
  id        Int     @id
  nome      String
  sigla     String
  descricao String
  publicar  Boolean
  consumir  Boolean
  status_id Int?
  status    Status? @relation(fields: [status_id], references: [id])

  @@map("tbtipowebservices")
}

model WebService {
  id        Int     @id
  nome      String
  descricao String
  prover    Boolean
  consumir  Boolean
  status_id Int?
  status    Status? @relation(fields: [status_id], references: [id])

  @@map("tbwebservices")
}

model TipoBases {
  id        Int     @id
  nome      String
  icone     String
  status_id Int?
  status    Status? @relation(fields: [status_id], references: [id])

  @@map("tbtipobases")
}

model Bases {
  id            Int       @id
  nome          String
  user          String
  password      String
  db_connection String
  host          String
  emp           Int
  fil           Int
  tipobase_id   Int
  url           String
  ip            String
  permissao     Int
  posts         Tabelas[]
  status_id     Int?
  status        Status?   @relation(fields: [status_id], references: [id])

  @@map("tbbases")
}

model Rotas {
  id        Int     @id
  status_id Int
  status    Status? @relation(fields: [status_id], references: [id])

  @@map("tbrotas")
}

model Tabelas {
  id            Int             @id @default(autoincrement())
  nome          String
  scheme        String
  base          Bases?          @relation(fields: [base_id], references: [id])
  base_id       Int?
  permissao     Int?
  TabelaOrigem  TabelaLigacao[] @relation("TabelaOrigem")
  TabelaDestino TabelaLigacao[] @relation("TabelaDestino")
  status_id     Int?
  status        Status?         @relation(fields: [status_id], references: [id])

  @@map("tbtabelas")
}

model Colunas {
  id            Int             @id
  nome          String
  pk            String
  fk            String
  tabela_id     Int
  permissao     Int
  ColunaOrigem  TabelaLigacao[] @relation("ColunaOrigem")
  ColunaDestino TabelaLigacao[] @relation("ColunaDestino")
  status_id     Int?
  status        Status?         @relation(fields: [status_id], references: [id])

  @@map("tbcolunas")
}

model TabelaLigacao {
  tabela_origem     Tabelas @relation(name: "TabelaOrigem", fields: [tabela_origem_id], references: [id])
  coluna_origem     Colunas @relation(name: "ColunaOrigem", fields: [coluna_origem_id], references: [id])
  tabela_destino    Tabelas @relation(name: "TabelaDestino", fields: [tabela_destino_id], references: [id])
  coluna_destino    Colunas @relation(name: "ColunaDestino", fields: [coluna_destino_id], references: [id])
  tabela_origem_id  Int
  coluna_origem_id  Int
  tabela_destino_id Int
  coluna_destino_id Int
  status_id         Int?
  status            Status? @relation(fields: [status_id], references: [id])

  @@id([tabela_origem_id, coluna_origem_id, tabela_destino_id, coluna_destino_id])
  @@map("tbtabelaligacoes")
}
